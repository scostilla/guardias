<div class="container">
  <div class="row">
    <div class="col-6">
      <div class="titulos">Distribución horaria</div>
    </div>
    <div class="col-6 m mt-3 d-flex justify-content-end">
      <button mat-fab class="button-primary" matTooltip="Volver atrás" routerLink="/personal">
        <mat-icon>keyboard_arrow_left</mat-icon>
      </button>
    </div>
  </div>

  <div class="row">
    <h5 class="['required']Field">*Campos Obligatorios</h5>
  </div>

  <div class="row">
  </div>

  <div class="row" *ngIf="horasStatus">
    <p>{{ horasStatus }}</p>
  </div>

  <div class="row">
    <mat-dialog-content class="mat-typography">
  
      <form [formGroup]="DistribucionForm" (ngSubmit)="saveDistribucion()">

        <mat-form-field appearance="fill">
          <mat-label>Profesional</mat-label>
          <input matInput formControlName="profesional" (click)="openAsistencialDialog()">
          <mat-icon matSuffix (click)="openAsistencialDialog()">person</mat-icon>
          <mat-error *ngIf="DistribucionForm.get('profesional')?.hasError('required')">
            El campo profesional es requerido.
          </mat-error>
        </mat-form-field>

        <mat-accordion class="example-headers-align">
          <!-- Panel 1 -->
          <mat-expansion-panel [expanded]="step === 0 && isPanelEnabled" (opened)="setStep(0)" hideToggle [disabled]="!isPanelEnabled">
            <mat-expansion-panel-header class="custom-header">
              <mat-panel-title>
                <div class="book-marker">
                  <span class="marker-number">1</span>
                </div>
                <span class="negrita">Guardias</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
        

              <mat-form-field appearance="fill"  style="margin-top: 20px;">
                  <mat-label>Servicio</mat-label>
                      <mat-select formControlName="servicioGuardia" [compareWith]="compareServicio">
                          <mat-option *ngFor="let servicio of servicios" [value]="servicio">{{ servicio.descripcion }}</mat-option>
                      </mat-select>
                  <mat-error *ngIf="DistribucionForm.get('servicioGuardia')?.errors?.['required']">El servicio es requerido.</mat-error>
            </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Tipo Guardia</mat-label>
                    <mat-select formControlName="tipoGuardia">
                      <mat-option value="CONTRAFACTURA">Contrafactura</mat-option>
                      <mat-option value="CARGO">Cargo</mat-option>
                      <mat-option value="EXTRA">Extra</mat-option>
                      <mat-option value="AGRUPACIÓN">Agrupación</mat-option>
                      <mat-option value="PASIVA">Pasiva</mat-option>
                    </mat-select>
                    <mat-error *ngIf="DistribucionForm?.get('tipoGuardia')?.errors?.['required']">El tipo de guardia es requerido.</mat-error>
                  </mat-form-field>

                  <mat-form-field appearance="fill">
                    <mat-label>Efector</mat-label>
                    <mat-select formControlName="efectorGuardia" [compareWith]="compareEfector">
                      <mat-option *ngFor="let hospital of hospitales" [value]="hospital.id">{{ hospital.nombre }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="DistribucionForm.get('efectorGuardia')?.errors?.['required']">El efector es requerido.</mat-error>
                  </mat-form-field>
            
                <mat-form-field appearance="fill">
                    <mat-label>Día</mat-label>
                    <mat-select formControlName="dia">
                      <mat-option value="LUNES">Lunes</mat-option>
                      <mat-option value="MARTES">Martes</mat-option>
                      <mat-option value="MIERCOLES">Miércoles</mat-option>
                      <mat-option value="JUEVES">Jueves</mat-option>
                      <mat-option value="VIERNES">Viernes</mat-option>
                      <mat-option value="SABADO">Sábado</mat-option>
                      <mat-option value="DOMINGO">Domingo</mat-option>
                    </mat-select>
                    <mat-error *ngIf="DistribucionForm?.get('dia')?.errors?.['required']">El día es requerido.</mat-error>
                  </mat-form-field>

                  <mat-form-field>
                    <mat-label>Fecha de Inicio</mat-label>
                    <input matInput [matDatepicker]="picker1" formControlName="fechaInicioGuardia" />
                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                    <mat-error *ngIf="DistribucionForm.get('fechaInicioGuardia')?.hasError('required')">La fecha de inicio es requerida.</mat-error>
                  </mat-form-field>
      
                  <mat-form-field>
                    <mat-label>Fecha de Finalización</mat-label>
                    <input matInput [matDatepicker]="picker2" formControlName="fechaFinalizacionGuardia" />
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                    <mat-error *ngIf="DistribucionForm.get('fechaFinalizacionGuardia')?.hasError('required')">La fecha de finalización es requerida.</mat-error>
                  </mat-form-field>
      
                  <mat-form-field appearance="fill" class="form-field">
                    <mat-label>Hora de Ingreso</mat-label>
                        <input matInput formControlName="horaIngresoGuardia" [ngxMatTimepicker]="horaPicker" [format]="24" readonly (click)="horaPicker.open()">
                        <ngx-mat-timepicker-toggle matSuffix [for]="horaPicker"></ngx-mat-timepicker-toggle>
                        <ngx-mat-timepicker #horaPicker></ngx-mat-timepicker>
                        <mat-error *ngIf="DistribucionForm?.get('horaIngresoGuardia')?.invalid && DistribucionForm?.get('horaIngresoGuardia')?.touched">
                            El campo es obligatorio (HH:mm).
                        </mat-error>
                </mat-form-field>

            <mat-form-field>
              <mat-label>Cantidad de horas</mat-label>
              <input matInput formControlName="cantidadHoras" (input)="updateHorasStatus()" type="number" />
            </mat-form-field>            
            <mat-action-row>
              <button mat-button color="primary" type="button" (click)="nextStep()">Siguiente</button>
            </mat-action-row>
          </mat-expansion-panel>
        
          <!-- Panel 2 -->
          <mat-expansion-panel [expanded]="step === 1 && isPanelEnabled" (opened)="setStep(1)" hideToggle [disabled]="!isPanelEnabled">
            <mat-expansion-panel-header class="custom-header">
              <mat-panel-title>
                <div class="book-marker">
                  <span class="marker-number">2</span>
                </div>
                <span class="negrita">Consultorio</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
          
            <mat-form-field appearance="fill" style="margin-top: 20px;">
              <mat-label>Tipo de Consultorio</mat-label>
              <mat-select formControlName="tipoConsultorio">
                <mat-option value="Consulta Externa">Consulta Externa</mat-option>
                <mat-option value="Interno">Interno</mat-option>
              </mat-select>
              <mat-error *ngIf="DistribucionForm.get('tipoConsultorio')?.errors?.['required']">El tipo de consultorio es requerido.</mat-error>
            </mat-form-field>
          
            <mat-form-field appearance="fill">
              <mat-label>Lugar</mat-label>
              <input matInput formControlName="lugar" />
              <mat-error *ngIf="DistribucionForm.get('lugar')?.errors?.['required']">El lugar es requerido.</mat-error>
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Efector</mat-label>
              <mat-select formControlName="efectorConsultorio" [compareWith]="compareEfector">
                <mat-option *ngFor="let hospital of hospitales" [value]="hospital.id">{{ hospital.nombre }}</mat-option>
              </mat-select>
              <mat-error *ngIf="DistribucionForm.get('efectorConsultorio')?.errors?.['required']">El efector es requerido.</mat-error>
            </mat-form-field>
          
            <mat-form-field appearance="fill">
              <mat-label>Servicio</mat-label>
              <mat-select formControlName="servicioConsultorio" [compareWith]="compareServicio">
                <mat-option *ngFor="let servicio of servicios" [value]="servicio">{{ servicio.descripcion }}</mat-option>
              </mat-select>
              <mat-error *ngIf="DistribucionForm.get('servicioConsultorio')?.errors?.['required']">El servicio es requerido.</mat-error>
            </mat-form-field>

            <mat-form-field>
              <mat-label>Fecha de Inicio</mat-label>
              <input matInput [matDatepicker]="picker1Consultorio" formControlName="fechaInicioConsultorio" />
              <mat-datepicker-toggle matSuffix [for]="picker1Consultorio"></mat-datepicker-toggle>
              <mat-datepicker #picker1Consultorio></mat-datepicker>
              <mat-error *ngIf="DistribucionForm.get('fechaInicioConsultorio')?.hasError('required')">La fecha de inicio es requerida.</mat-error>
            </mat-form-field>

            <mat-form-field>
              <mat-label>Fecha de Finalización</mat-label>
              <input matInput [matDatepicker]="picker2Consultorio" formControlName="fechaFinalizacionConsultorio" />
              <mat-datepicker-toggle matSuffix [for]="picker2Consultorio"></mat-datepicker-toggle>
              <mat-datepicker #picker2Consultorio></mat-datepicker>
              <mat-error *ngIf="DistribucionForm.get('fechaFinalizacionConsultorio')?.hasError('required')">La fecha de finalización es requerida.</mat-error>
            </mat-form-field>

            <mat-form-field appearance="fill" class="form-field">
              <mat-label>Hora de Ingreso</mat-label>
                  <input matInput formControlName="horaIngresoConsultorio" [ngxMatTimepicker]="horaPicker2" [format]="24" readonly (click)="horaPicker.open()">
                  <ngx-mat-timepicker-toggle matSuffix [for]="horaPicker2"></ngx-mat-timepicker-toggle>
                  <ngx-mat-timepicker #horaPicker2></ngx-mat-timepicker>
                  <mat-error *ngIf="DistribucionForm?.get('horaIngresoConsultorio')?.invalid && DistribucionForm?.get('horaIngresoConsultorio')?.touched">
                      El campo es obligatorio (HH:mm).
                  </mat-error>
          </mat-form-field>
          
            <mat-form-field>
              <mat-label>Cantidad de horas</mat-label>
              <input matInput formControlName="cantidadHorasConsultorio" (input)="updateHorasStatus()" type="number" />
              <mat-error *ngIf="DistribucionForm.get('cantidadHorasConsultorio')?.errors?.['required']">La cantidad de horas es requerida.</mat-error>
            </mat-form-field>
          
            <mat-action-row>
              <button mat-button color="warn" type="button" (click)="prevStep()">Anterior</button>
              <button mat-button color="primary" type="button" (click)="nextStep()">Siguiente</button>
            </mat-action-row>
          </mat-expansion-panel>

          <!-- Panel 3 -->
          <mat-expansion-panel [expanded]="step === 2 && isPanelEnabled" (opened)="setStep(2)" hideToggle [disabled]="!isPanelEnabled">
            <mat-expansion-panel-header class="custom-header">
              <mat-panel-title>
                <div class="book-marker">
                  <span class="marker-number">3</span>
                </div>
                <span class="negrita">Giras médicas</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
        


            <mat-action-row>
              <button mat-button color="warn" type="button" (click)="prevStep()">Anterior</button>
              <button mat-button color="primary" type="button" (click)="nextStep()">Siguiente</button>
            </mat-action-row>
          </mat-expansion-panel>
        
          <!-- Panel 4 -->
          <mat-expansion-panel [expanded]="step === 3 && isPanelEnabled" (opened)="setStep(3)"  hideToggle [disabled]="!isPanelEnabled">
            <mat-expansion-panel-header class="custom-header">
              <mat-panel-title>
                <div class="book-marker">
                  <span class="marker-number">4</span>
                </div>
                <span class="negrita">Otras actividades</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
        


            <mat-action-row>
              <button mat-button color="warn" type="button" (click)="prevStep()">Anterior</button>
              <button mat-raised-button color="primary" type="submit" [disabled]="!isFormValidAndHorasValid">
                Guardar
              </button>
            </mat-action-row>
          </mat-expansion-panel>
        </mat-accordion>
      
        <div mat-dialog-actions class="action mt-4">
          <button mat-raised-button color="secondary" type="button" (click)="cancel()">
            Cancelar
          </button>
        </div>
      </form>
    </mat-dialog-content>
  </div>
  </div>
  
  
  
  
  
  
  
  
  
    <div mat-dialog-content class="content">
  
      <p>Guardias
        <button mat-icon-button color="primary" (click)="openDistGuardia()" matTooltip="Agregar nuevo día de guardia"
          >
          <mat-icon>playlist_add</mat-icon>
        </button>
      </p>
  
      <p>Consultorio
        <button mat-icon-button color="primary" (click)="openDistCons()" matTooltip="Agregar nuevo día de consultorio"
          >
          <mat-icon>playlist_add</mat-icon>
        </button>
      </p>
  
      <p>Giras médicas
        <button mat-icon-button color="primary" (click)="openDistGira()" matTooltip="Agregar nuevo día de gira médica"
          >
          <mat-icon>playlist_add</mat-icon>
        </button>
      </p>
  
      <p>Otras actividades
        <button mat-icon-button color="primary" (click)="openDistOtra()" matTooltip="Agregar nuevo día de actividad"
          >
          <mat-icon>playlist_add</mat-icon>
        </button>
      </p>
    </div>
  

